import { Component, AfterViewInit, viewChild, ElementRef } from '@angular/core';
import * as L from 'leaflet';

// üî• Ajustar los √≠conos para Angular
const iconRetinaUrl = 'assets/marker-icon-2x.png';
const iconUrl = 'assets/marker-icon.png';
const shadowUrl = 'assets/marker-shadow.png';

L.Marker.prototype.options.icon = L.icon({
  iconRetinaUrl,
  iconUrl,
  shadowUrl,
  iconSize: [25, 41],
  iconAnchor: [12, 41],
  popupAnchor: [1, -34],
  tooltipAnchor: [16, -28],
  shadowSize: [41, 41],
});

@Component({
  selector: 'app-map-view',
  standalone: true,
  imports: [],
  templateUrl: './map-view.component.html',
  styleUrl: './map-view.component.css'
})
export class MapViewComponent implements AfterViewInit {
  private map!: L.Map;
  // divElement = viewChild<ElementRef>('map')

  ngAfterViewInit(): void {
    this.initMap();
    this.loadPolygons();

    // // üî• Arreglar mapa gris
    // setTimeout(() => {
    //   this.map.invalidateSize();
    // }, 80);
  }

  private initMap(): void {
    // console.log(this.divElement);
    this.map = L.map('map', {
      center: [-0.3306539, -78.6667172],
      zoom: 8,
    });

    // L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
      attribution: 'markiup.com',
      maxZoom: 15,
    }).addTo(this.map);

    // L.marker([-0.180653, -78.467834])
    //   .addTo(this.map)
    //   .bindPopup('Quito, Ecuador')
    //   .openPopup();
  }

  /**
    * Carga din√°micamente los archivos GeoJSON de la carpeta assets/polygons.
    */
  private loadPolygons(): void {
    // Verificamos que el mapa est√© inicializado antes de intentar cargar los pol√≠gonos.
    if (!this.map) {
      console.error('El mapa no ha sido inicializado.');
      return;
    }

    // Obtenemos los nombres de los archivos de pol√≠gonos del directorio.
    // En un entorno de desarrollo real, esta lista tendr√≠a que ser generada de alguna manera.
    // Aqu√≠ usamos un enfoque simplificado con una lista predefinida para demostrar el concepto.
    const polygons = [
      { dpa: '05', estado: 'o' },
      { dpa: '08', estado: 'o' },
      { dpa: '10', estado: 'o' },
      { dpa: '12', estado: 'o' },
      { dpa: '13', estado: 'err' },
      { dpa: '17', estado: 'ok' },
      { dpa: '21', estado: 'war' },
      { dpa: '23', estado: 'o' }

      // { dpa: '0401', estado: 'ok' },
      // { dpa: '0402', estado: 'ok' },
      // { dpa: '0403', estado: 'ok' },
      // { dpa: '0404', estado: 'ok' },
      // { dpa: '0405', estado: 'ok' },
      // { dpa: '0406', estado: 'ok' },
      // { dpa: '0501', estado: 'ok' },
      // { dpa: '0502', estado: 'ok' },
      // { dpa: '0503', estado: 'err' },
      // { dpa: '0504', estado: 'ok' },
      // { dpa: '0505', estado: 'ok' },
      // { dpa: '0506', estado: 'ok' },
      // { dpa: '0507', estado: 'ok' },
      // { dpa: '0801', estado: 'ok' },
      // { dpa: '0802', estado: 'ok' },
      // { dpa: '0803', estado: 'ok' },
      // { dpa: '0804', estado: 'err' },
      // { dpa: '0805', estado: 'ok' },
      // { dpa: '0806', estado: 'ok' },
      // { dpa: '0807', estado: 'ok' },
      // { dpa: '1001', estado: 'ok' },
      // { dpa: '1002', estado: 'ok' },
      // { dpa: '1003', estado: 'ok' },
      // { dpa: '1004', estado: 'ok' },
      // { dpa: '1005', estado: 'ok' },
      // { dpa: '1006', estado: 'ok' },
      // { dpa: '1201', estado: 'ok' },
      // { dpa: '1202', estado: 'o' },
      // { dpa: '1203', estado: 'ok' },
      // { dpa: '1204', estado: 'ok' },
      // { dpa: '1205', estado: 'ok' },
      // { dpa: '1206', estado: 'ok' },
      // { dpa: '1207', estado: 'ok' },
      // { dpa: '1208', estado: 'ok' },
      // { dpa: '1209', estado: 'ok' },
      // { dpa: '1210', estado: 'ok' },
      // { dpa: '1211', estado: 'ok' },
      // { dpa: '1212', estado: 'ok' },
      // { dpa: '1213', estado: 'ok' },
      // { dpa: '1301', estado: 'ok' },
      // { dpa: '1302', estado: 'ok' },
      // { dpa: '1303', estado: 'ok' },
      // { dpa: '1304', estado: 'ok' },
      // { dpa: '1305', estado: 'ok' },
      // { dpa: '1306', estado: 'ok' },
      // { dpa: '1307', estado: 'ok' },
      // { dpa: '1308', estado: 'ok' },
      // { dpa: '1309', estado: 'ok' },
      // { dpa: '1310', estado: 'ok' },
      // { dpa: '1311', estado: 'ok' },
      // { dpa: '1312', estado: 'ok' },
      // { dpa: '1313', estado: 'ok' },
      // { dpa: '1314', estado: 'ok' },
      // { dpa: '1315', estado: 'ok' },
      // { dpa: '1316', estado: 'ok' },
      // { dpa: '1317', estado: 'ok' },
      // { dpa: '1318', estado: 'ok' },
      // { dpa: '1319', estado: 'ok' },
      // { dpa: '1320', estado: 'ok' },
      // { dpa: '1321', estado: 'ok' },
      // { dpa: '1322', estado: 'ok' },
      // { dpa: '1701', estado: 'ok' },
      // { dpa: '1702', estado: 'ok' },
      // { dpa: '1703', estado: 'ok' },
      // { dpa: '1704', estado: 'ok' },
      // { dpa: '1705', estado: 'ok' },
      // { dpa: '1707', estado: 'ok' },
      // { dpa: '1708', estado: 'ok' },
      // { dpa: '1709', estado: 'ok' },
      // { dpa: '2101', estado: 'ok' },
      // { dpa: '2102', estado: 'ok' },
      // { dpa: '2103', estado: 'ok' },
      // { dpa: '2104', estado: 'ok' },
      // { dpa: '2105', estado: 'ok' },
      // { dpa: '2106', estado: 'ok' },
      // { dpa: '2107', estado: 'ok' },
      // { dpa: '2301', estado: 'ok' },
      // { dpa: '2302', estado: 'ok' }

      // { dpa: '040150', estado: 'ok' },
      // { dpa: '040151', estado: 'ok' },
      // { dpa: '040153', estado: 'ok' },
      // { dpa: '040154', estado: 'ok' },
      // { dpa: '040155', estado: 'ok' },
      // { dpa: '040156', estado: 'ok' },
      // { dpa: '040157', estado: 'ok' },
      // { dpa: '040158', estado: 'ok' },
      // { dpa: '040159', estado: 'ok' },
      // { dpa: '040161', estado: 'ok' },
      // { dpa: '040250', estado: 'ok' },
      // { dpa: '040251', estado: 'ok' },
      // { dpa: '040252', estado: 'war' },
      // { dpa: '040253', estado: 'ok' },
      // { dpa: '040254', estado: 'war' },
      // { dpa: '040255', estado: 'ok' },
      // { dpa: '040350', estado: 'ok' },
      // { dpa: '040351', estado: 'ok' },
      // { dpa: '040352', estado: 'ok' },
      // { dpa: '040353', estado: 'ok' },
      // { dpa: '040450', estado: 'war' },
      // { dpa: '040451', estado: 'ok' },
      // { dpa: '040452', estado: 'ok' },
      // { dpa: '040453', estado: 'err' },
      // { dpa: '040550', estado: 'err' },
      // { dpa: '040551', estado: 'ok' },
      // { dpa: '040552', estado: 'ok' },
      // { dpa: '040553', estado: 'ok' },
      // { dpa: '040554', estado: 'ok' },
      // { dpa: '040555', estado: 'ok' },
      // { dpa: '040650', estado: 'ok' },
      // { dpa: '040651', estado: 'ok' },
      // { dpa: '050150', estado: 'ni' },
      // { dpa: '050151', estado: 'ni' },
      // { dpa: '050152', estado: 'ni' },
      // { dpa: '050153', estado: 'ni' },
      // { dpa: '050154', estado: 'ni' },
      // { dpa: '050156', estado: 'ni' },
      // { dpa: '050157', estado: 'ni' },
      // { dpa: '050158', estado: 'ni' },
      // { dpa: '050159', estado: 'ni' },
      // { dpa: '050161', estado: 'ni' },
      // { dpa: '050162', estado: 'ni' },
      // { dpa: '050250', estado: 'ni' },
      // { dpa: '050251', estado: 'ni' },
      // { dpa: '050252', estado: 'ni' },
      // { dpa: '050350', estado: 'ni' },
      // { dpa: '050351', estado: 'ni' },
      // { dpa: '050352', estado: 'ni' },
      // { dpa: '050353', estado: 'ni' },
      // { dpa: '050450', estado: 'ni' },
      // { dpa: '050451', estado: 'ni' },
      // { dpa: '050453', estado: 'ni' },
      // { dpa: '050455', estado: 'ni' },
      // { dpa: '050456', estado: 'ni' },
      // { dpa: '050457', estado: 'ni' },
      // { dpa: '050458', estado: 'ni' },
      // { dpa: '050550', estado: 'ni' },
      // { dpa: '050551', estado: 'ni' },
      // { dpa: '050552', estado: 'ni' },
      // { dpa: '050553', estado: 'ni' },
      // { dpa: '050554', estado: 'ni' },
      // { dpa: '050555', estado: 'ni' },
      // { dpa: '050650', estado: 'ni' },
      // { dpa: '050651', estado: 'ni' },
      // { dpa: '050652', estado: 'ni' },
      // { dpa: '050653', estado: 'ni' },
      // { dpa: '050750', estado: 'ni' },
      // { dpa: '050751', estado: 'ni' },
      // { dpa: '050752', estado: 'ni' },
      // { dpa: '050753', estado: 'ni' },
      // { dpa: '050754', estado: 'ni' },
      // { dpa: '080150', estado: 'ni' },
      // { dpa: '080152', estado: 'ni' },
      // { dpa: '080153', estado: 'ni' },
      // { dpa: '080154', estado: 'ni' },
      // { dpa: '080159', estado: 'ni' },
      // { dpa: '080163', estado: 'ni' },
      // { dpa: '080165', estado: 'ni' },
      // { dpa: '080166', estado: 'ni' },
      // { dpa: '080168', estado: 'ni' },
      // { dpa: '080251', estado: 'ni' },
      // { dpa: '080252', estado: 'ni' },
      // { dpa: '080253', estado: 'ni' },
      // { dpa: '080254', estado: 'ni' },
      // { dpa: '080255', estado: 'ni' },
      // { dpa: '080256', estado: 'ni' },
      // { dpa: '080258', estado: 'ni' },
      // { dpa: '080259', estado: 'ni' },
      // { dpa: '080260', estado: 'ni' },
      // { dpa: '080261', estado: 'ni' },
      // { dpa: '080262', estado: 'ni' },
      // { dpa: '080263', estado: 'ni' },
      // { dpa: '080264', estado: 'ni' },
      // { dpa: '080265', estado: 'ni' },
      // { dpa: '080350', estado: 'ni' },
      // { dpa: '080351', estado: 'ni' },
      // { dpa: '080352', estado: 'ni' },
      // { dpa: '080353', estado: 'ni' },
      // { dpa: '080354', estado: 'ni' },
      // { dpa: '080355', estado: 'ni' },
      // { dpa: '080356', estado: 'ni' },
      // { dpa: '080357', estado: 'ni' },
      // { dpa: '080358', estado: 'ni' },
      // { dpa: '080450', estado: 'ni' },
      // { dpa: '080451', estado: 'ni' },
      // { dpa: '080452', estado: 'ni' },
      // { dpa: '080453', estado: 'ni' },
      // { dpa: '080454', estado: 'ni' },
      // { dpa: '080455', estado: 'ni' },
      // { dpa: '080550', estado: 'ni' },
      // { dpa: '080551', estado: 'ni' },
      // { dpa: '080553', estado: 'ni' },
      // { dpa: '080554', estado: 'ni' },
      // { dpa: '080555', estado: 'ni' },
      // { dpa: '080556', estado: 'ni' },
      // { dpa: '080557', estado: 'ni' },
      // { dpa: '080558', estado: 'ni' },
      // { dpa: '080559', estado: 'ni' },
      // { dpa: '080560', estado: 'ni' },
      // { dpa: '080561', estado: 'ni' },
      // { dpa: '080562', estado: 'ni' },
      // { dpa: '080650', estado: 'ni' },
      // { dpa: '080651', estado: 'ni' },
      // { dpa: '080652', estado: 'ni' },
      // { dpa: '080653', estado: 'ni' },
      // { dpa: '080654', estado: 'ni' },
      // { dpa: '080750', estado: 'ni' },
      // { dpa: '080751', estado: 'ni' },
      // { dpa: '080752', estado: 'ni' },
      // { dpa: '080753', estado: 'ni' },
      // { dpa: '080754', estado: 'ni' },
      // { dpa: '080755', estado: 'ni' },
      // { dpa: '100150', estado: 'ni' },
      // { dpa: '100151', estado: 'ni' },
      // { dpa: '100152', estado: 'ni' },
      // { dpa: '100153', estado: 'ni' },
      // { dpa: '100154', estado: 'ni' },
      // { dpa: '100155', estado: 'ni' },
      // { dpa: '100156', estado: 'ni' },
      // { dpa: '100157', estado: 'ni' },
      // { dpa: '100250', estado: 'ni' },
      // { dpa: '100251', estado: 'ni' },
      // { dpa: '100252', estado: 'ni' },
      // { dpa: '100253', estado: 'ni' },
      // { dpa: '100254', estado: 'ni' },
      // { dpa: '100350', estado: 'ni' },
      // { dpa: '100351', estado: 'ni' },
      // { dpa: '100352', estado: 'ni' },
      // { dpa: '100353', estado: 'ni' },
      // { dpa: '100354', estado: 'ni' },
      // { dpa: '100355', estado: 'ni' },
      // { dpa: '100356', estado: 'ni' },
      // { dpa: '100357', estado: 'ni' },
      // { dpa: '100358', estado: 'ni' },
      // { dpa: '100450', estado: 'ni' },
      // { dpa: '100451', estado: 'ni' },
      // { dpa: '100452', estado: 'ni' },
      // { dpa: '100453', estado: 'ni' },
      // { dpa: '100454', estado: 'ni' },
      // { dpa: '100455', estado: 'ni' },
      // { dpa: '100456', estado: 'ni' },
      // { dpa: '100457', estado: 'ni' },
      // { dpa: '100458', estado: 'ni' },
      // { dpa: '100459', estado: 'ni' },
      // { dpa: '100550', estado: 'ni' },
      // { dpa: '100551', estado: 'ni' },
      // { dpa: '100552', estado: 'ni' },
      // { dpa: '100553', estado: 'ni' },
      // { dpa: '100650', estado: 'ni' },
      // { dpa: '100651', estado: 'ni' },
      // { dpa: '100652', estado: 'ni' },
      // { dpa: '100653', estado: 'ni' },
      // { dpa: '100654', estado: 'ni' },
      // { dpa: '100655', estado: 'ni' },
      // { dpa: '120150', estado: 'ni' },
      // { dpa: '120152', estado: 'ni' },
      // { dpa: '120153', estado: 'ni' },
      // { dpa: '120154', estado: 'ni' },
      // { dpa: '120155', estado: 'ni' },
      // { dpa: '120250', estado: 'ni' },
      // { dpa: '120251', estado: 'ni' },
      // { dpa: '120252', estado: 'ni' },
      // { dpa: '120350', estado: 'ni' },
      // { dpa: '120351', estado: 'ni' },
      // { dpa: '120450', estado: 'ni' },
      // { dpa: '120451', estado: 'ni' },
      // { dpa: '120452', estado: 'ni' },
      // { dpa: '120550', estado: 'ni' },
      // { dpa: '120553', estado: 'ni' },
      // { dpa: '120555', estado: 'ni' },
      // { dpa: '120650', estado: 'ni' },
      // { dpa: '120651', estado: 'ni' },
      // { dpa: '120750', estado: 'ni' },
      // { dpa: '120752', estado: 'ni' },
      // { dpa: '120753', estado: 'ni' },
      // { dpa: '120754', estado: 'ni' },
      // { dpa: '120850', estado: 'ni' },
      // { dpa: '120851', estado: 'ni' },
      // { dpa: '120950', estado: 'ni' },
      // { dpa: '121050', estado: 'ni' },
      // { dpa: '121051', estado: 'ni' },
      // { dpa: '121150', estado: 'ni' },
      // { dpa: '121250', estado: 'ni' },
      // { dpa: '121350', estado: 'ni' },
      // { dpa: '130150', estado: 'ni' },
      // { dpa: '130151', estado: 'ni' },
      // { dpa: '130152', estado: 'ni' },
      // { dpa: '130153', estado: 'ni' },
      // { dpa: '130154', estado: 'ni' },
      // { dpa: '130155', estado: 'ni' },
      // { dpa: '130156', estado: 'ni' },
      // { dpa: '130157', estado: 'ni' },
      // { dpa: '130250', estado: 'ni' },
      // { dpa: '130251', estado: 'ni' },
      // { dpa: '130252', estado: 'ni' },
      // { dpa: '130350', estado: 'ni' },
      // { dpa: '130351', estado: 'ni' },
      // { dpa: '130352', estado: 'ni' },
      // { dpa: '130353', estado: 'ni' },
      // { dpa: '130354', estado: 'ni' },
      // { dpa: '130355', estado: 'ni' },
      // { dpa: '130356', estado: 'ni' },
      // { dpa: '130357', estado: 'ni' },
      // { dpa: '130450', estado: 'ni' },
      // { dpa: '130451', estado: 'ni' },
      // { dpa: '130452', estado: 'ni' },
      // { dpa: '130453', estado: 'ni' },
      // { dpa: '130454', estado: 'ni' },
      // { dpa: '130550', estado: 'ni' },
      // { dpa: '130551', estado: 'ni' },
      // { dpa: '130552', estado: 'ni' },
      // { dpa: '130650', estado: 'ni' },
      // { dpa: '130651', estado: 'ni' },
      // { dpa: '130652', estado: 'ni' },
      // { dpa: '130653', estado: 'ni' },
      // { dpa: '130654', estado: 'ni' },
      // { dpa: '130656', estado: 'ni' },
      // { dpa: '130657', estado: 'ni' },
      // { dpa: '130658', estado: 'ni' },
      // { dpa: '130750', estado: 'ni' },
      // { dpa: '130850', estado: 'ni' },
      // { dpa: '130851', estado: 'ni' },
      // { dpa: '130852', estado: 'ni' },
      // { dpa: '130950', estado: 'ni' },
      // { dpa: '130952', estado: 'ni' },
      // { dpa: '131050', estado: 'ni' },
      // { dpa: '131051', estado: 'ni' },
      // { dpa: '131052', estado: 'ni' },
      // { dpa: '131053', estado: 'ni' },
      // { dpa: '131054', estado: 'ni' },
      // { dpa: '131150', estado: 'ni' },
      // { dpa: '131151', estado: 'ni' },
      // { dpa: '131152', estado: 'ni' },
      // { dpa: '131250', estado: 'ni' },
      // { dpa: '131251', estado: 'ni' },
      // { dpa: '131350', estado: 'ni' },
      // { dpa: '131351', estado: 'ni' },
      // { dpa: '131352', estado: 'ni' },
      // { dpa: '131353', estado: 'ni' },
      // { dpa: '131355', estado: 'ni' },
      // { dpa: '131450', estado: 'ni' },
      // { dpa: '131453', estado: 'ni' },
      // { dpa: '131457', estado: 'ni' },
      // { dpa: '131550', estado: 'ni' },
      // { dpa: '131551', estado: 'ni' },
      // { dpa: '131552', estado: 'ni' },
      // { dpa: '131650', estado: 'ni' },
      // { dpa: '131651', estado: 'ni' },
      // { dpa: '131652', estado: 'ni' },
      // { dpa: '131653', estado: 'ni' },
      // { dpa: '131750', estado: 'ni' },
      // { dpa: '131751', estado: 'ni' },
      // { dpa: '131752', estado: 'ni' },
      // { dpa: '131753', estado: 'ni' },
      // { dpa: '131850', estado: 'ni' },
      // { dpa: '131950', estado: 'ni' },
      // { dpa: '131951', estado: 'ni' },
      // { dpa: '131952', estado: 'ni' },
      // { dpa: '132050', estado: 'ni' },
      // { dpa: '132150', estado: 'ni' },
      // { dpa: '132250', estado: 'ni' },
      // { dpa: '132251', estado: 'ni' },
      // { dpa: '170150', estado: 'ok' },
      // { dpa: '170151', estado: 'ok' },
      // { dpa: '170152', estado: 'ok' },
      // { dpa: '170153', estado: 'ok' },
      // { dpa: '170154', estado: 'ok' },
      // { dpa: '170155', estado: 'ok' },
      // { dpa: '170156', estado: 'ok' },
      // { dpa: '170157', estado: 'ok' },
      // { dpa: '170158', estado: 'ok' },
      // { dpa: '170159', estado: 'ok' },
      // { dpa: '170160', estado: 'ok' },
      // { dpa: '170161', estado: 'ok' },
      // { dpa: '170162', estado: 'ok' },
      // { dpa: '170163', estado: 'ok' },
      // { dpa: '170164', estado: 'ok' },
      // { dpa: '170165', estado: 'ok' },
      // { dpa: '170166', estado: 'ok' },
      // { dpa: '170168', estado: 'ok' },
      // { dpa: '170169', estado: 'ok' },
      // { dpa: '170170', estado: 'ok' },
      // { dpa: '170171', estado: 'ok' },
      // { dpa: '170172', estado: 'ok' },
      // { dpa: '170174', estado: 'war' },
      // { dpa: '170175', estado: 'ok' },
      // { dpa: '170176', estado: 'ok' },
      // { dpa: '170177', estado: 'ok' },
      // { dpa: '170178', estado: 'ok' },
      // { dpa: '170179', estado: 'war' },
      // { dpa: '170180', estado: 'ok' },
      // { dpa: '170181', estado: 'ok' },
      // { dpa: '170183', estado: 'ok' },
      // { dpa: '170184', estado: 'war' },
      // { dpa: '170185', estado: 'ok' },
      // { dpa: '170186', estado: 'ok' },
      // { dpa: '170250', estado: 'ok' },
      // { dpa: '170251', estado: 'err' },
      // { dpa: '170252', estado: 'ok' },
      // { dpa: '170253', estado: 'ok' },
      // { dpa: '170254', estado: 'ok' },
      // { dpa: '170255', estado: 'err' },
      // { dpa: '170256', estado: 'ok' },
      // { dpa: '170257', estado: 'ok' },
      // { dpa: '170350', estado: 'ok' },
      // { dpa: '170351', estado: 'ok' },
      // { dpa: '170352', estado: 'ok' },
      // { dpa: '170353', estado: 'ok' },
      // { dpa: '170354', estado: 'ok' },
      // { dpa: '170355', estado: 'ok' },
      // { dpa: '170356', estado: 'ok' },
      // { dpa: '170357', estado: 'ok' },
      // { dpa: '170450', estado: 'ok' },
      // { dpa: '170451', estado: 'ok' },
      // { dpa: '170452', estado: 'ok' },
      // { dpa: '170453', estado: 'ok' },
      // { dpa: '170454', estado: 'ok' },
      // { dpa: '170550', estado: 'ok' },
      // { dpa: '170551', estado: 'ok' },
      // { dpa: '170552', estado: 'ok' },
      // { dpa: '170750', estado: 'ok' },
      // { dpa: '170751', estado: 'ok' },
      // { dpa: '170850', estado: 'ok' },
      // { dpa: '170950', estado: 'ok' },
      // { dpa: '210150', estado: 'ni' },
      // { dpa: '210152', estado: 'ni' },
      // { dpa: '210153', estado: 'ni' },
      // { dpa: '210155', estado: 'ni' },
      // { dpa: '210156', estado: 'ni' },
      // { dpa: '210157', estado: 'ni' },
      // { dpa: '210158', estado: 'ni' },
      // { dpa: '210160', estado: 'ni' },
      // { dpa: '210250', estado: 'ni' },
      // { dpa: '210251', estado: 'ni' },
      // { dpa: '210252', estado: 'ni' },
      // { dpa: '210254', estado: 'ni' },
      // { dpa: '210350', estado: 'ni' },
      // { dpa: '210351', estado: 'ni' },
      // { dpa: '210352', estado: 'ni' },
      // { dpa: '210353', estado: 'ni' },
      // { dpa: '210354', estado: 'ni' },
      // { dpa: '210355', estado: 'ni' },
      // { dpa: '210450', estado: 'ni' },
      // { dpa: '210451', estado: 'ni' },
      // { dpa: '210452', estado: 'ni' },
      // { dpa: '210453', estado: 'ni' },
      // { dpa: '210454', estado: 'ni' },
      // { dpa: '210455', estado: 'ni' },
      // { dpa: '210456', estado: 'ni' },
      // { dpa: '210457', estado: 'ni' },
      // { dpa: '210550', estado: 'ni' },
      // { dpa: '210551', estado: 'ni' },
      // { dpa: '210552', estado: 'ni' },
      // { dpa: '210553', estado: 'ni' },
      // { dpa: '210554', estado: 'ni' },
      // { dpa: '210650', estado: 'ni' },
      // { dpa: '210651', estado: 'ni' },
      // { dpa: '210652', estado: 'ni' },
      // { dpa: '210653', estado: 'ni' },
      // { dpa: '210750', estado: 'ni' },
      // { dpa: '210751', estado: 'ni' },
      // { dpa: '210752', estado: 'ni' },
      // { dpa: '230150', estado: 'ni' },
      // { dpa: '230151', estado: 'ni' },
      // { dpa: '230152', estado: 'ni' },
      // { dpa: '230153', estado: 'ni' },
      // { dpa: '230154', estado: 'ni' },
      // { dpa: '230155', estado: 'ni' },
      // { dpa: '230156', estado: 'ni' },
      // { dpa: '230157', estado: 'ni' },
      // { dpa: '230250', estado: 'ni' },
      // { dpa: '230251', estado: 'ni' },
      // { dpa: '230252', estado: 'ni' },
      // { dpa: '230253', estado: 'ni' }
    ];

    polygons.forEach(polygon => {
      // Usamos fetch para obtener el contenido de cada archivo GeoJSON.
      fetch(`assets/polygons/${polygon.dpa}.geojson`)
        .then(response => {
          // Si la respuesta no es exitosa, lanzamos un error.
          if (!response.ok) {
            throw new Error(`No se pudo cargar el archivo GeoJSON: ${polygon.dpa}`);
          }
          // Convertimos la respuesta a formato JSON.
          return response.json();
        })
        .then(geoJsonData => {
          // Creamos una capa GeoJSON y la a√±adimos al mapa.
          // Aqu√≠ puedes personalizar los estilos del pol√≠gono.
          let color = polygon.estado == 'ok' ? '#2c6e49' :
            polygon.estado == 'err' ? '#9d0208' :
              polygon.estado == 'war' ?
                '#ff9500' : '#ffffff';
          L.geoJSON(geoJsonData, {
            style: {
              color: '#000000',
              weight: 2,
              opacity: 0.65,
              fillColor: color,
              fillOpacity: 0.4
            }
          }).addTo(this.map!); // El "!" asegura a TypeScript que el mapa no es nulo.
        })
        .catch(error => {
          // Capturamos y mostramos cualquier error que ocurra durante la carga.
          console.error(`Error al cargar el pol√≠gono  ${polygon.dpa}:`, error);
        });
    });
  }

}
